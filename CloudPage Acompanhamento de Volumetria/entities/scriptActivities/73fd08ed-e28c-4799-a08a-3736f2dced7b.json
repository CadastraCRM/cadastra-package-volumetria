{"issues":[],"originID":"73fd08ed-e28c-4799-a08a-3736f2dced7b","originEID":"mcxwlsp6p8x6296tw57v3kht-t24","data":{"categoryId":"{{mcpm#/entities/categories/15090/data/id}}","description":"","key":"1a206e0e-58f2-4189-9483-2d08f042d0ad","name":"Script_Volumetria_Whatsapp_Supermessages","script":"<script runat=\"server\">\nPlatform.Load(\"core\", \"1\");\n\ntry {\n    var customerKey = \"005F8EFF-BC07-442B-BD21-25C215F31FA9\";\n    var de = DataExtension.Init(customerKey);\n\n    var rows = de.Rows.Retrieve({\n        Property: \"validator\",\n        SimpleOperator: \"equals\",\n        Value: \"-\"\n    });\n\n    if (rows && rows.length > 0) {\n        for (var i = 0; i < rows.length; i++) {\n            var row = rows[i];\n\n            var qtdSMS = isNaN(parseFloat(row.qtdSMS)) ? 0 : parseFloat(row.qtdSMS);\n            var supermessages = qtdSMS * 12.88;\n\n            var qtdWhatsapp = isNaN(parseFloat(row.qtdWhatsapp)) ? 0 : parseFloat(row.qtdWhatsapp);\n            var whatsapp = qtdWhatsapp * 77.17;\n\n            var updateResult = de.Rows.Update(\n                {\n                    qtdSupermessages: supermessages,\n                    qtdWhatsapp: whatsapp\n                },\n                [\"MesAno\"],\n                [row.MesAno]\n            );\n        }\n\n        Write(\"Supermessages e Whatsapp calculadas e DE atualizada.\");\n    } else {\n        Write(\"Nenhum registro encontrado com Ano = 2025.\");\n    }\n\n} catch (error) {\n    Write(\"<br>Erro no processamento: \" + Stringify(error));\n}\n</script>"}}